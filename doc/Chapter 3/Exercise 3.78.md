## [Chapter 3](../index.md#3-Modularity-Objects-and-State)

### [Exercise 3.78](https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-24.html#%_thm_3.78)

<p align="center">
  <img src="https://i.ibb.co/TPVxhBX/SICPexercise3-78-1.png" alt="SICPexercise3.78.1" title="SICPexercise3.78.1">
</p>

Consider the problem of designing a signal-processing system to study the homogeneous second-order linear differential equation

<p align="center">
  <img src="https://i.ibb.co/cYBCn0M/SICPexercise3-78-2.png" alt="SICPexercise3.78.2" title="SICPexercise3.78.2">
</p>

The output stream, modeling _y_, is generated by a network that contains a loop. This is because the value of <i>d</i>²<i>y</i>/<i>dt</i>² depends upon the values of _y_ and _dy_/_dt_ and both of these are determined by integrating <i>d</i>²<i>y</i>/<i>dt</i>². The diagram we would like to encode is shown in [figure 3.35][1]. Write a procedure `solve-2nd` that takes as arguments the constants _a_, _b_, and _dt_ and the initial values <i>y</i>₀ and <i>dy</i>₀ for _y_ and _dy_/_dt_ and generates the stream of successive values of _y_. 

### Solution

```scheme
(define (solve-2nd a b y0 dy0 dt)
  (define y (integral (delay dy) y0 dt))
  (define dy (integral (delay ddy) dy0 dt))
  (define ddy (add-stream (scale-stream y b)
                          (scale-stream dy a)))
  y)
```

[1]: https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-24.html#%_fig_3.35

